package com.mylearn.util.excel;

import javax.swing.*;
import javax.swing.filechooser.FileFilter;
import java.io.File;

/**
 * Package:com.jd.ebook.admin.service.excel
 * User: yingkuohao
 * Date: 12-2-20
 * Time: ????10:43
 * CopyRight:360buy
 * Descrption:     ??applet??main?????????????????
 */
public class TestApplet extends JFrame {

    chooseFile Jfc = new chooseFile();            //??b???????????? Jfc

    public static void main(String args[]) {
        TestApplet frame1 = new TestApplet();
        frame1.setTitle("????????????????");
        frame1.setSize(550, 350);
        frame1.setVisible(true);
    }

    public TestApplet() {
        Filter filter = new Filter();                 //??b?????????? filter
        Jfc.addChoosableFileFilter(filter);           //??????????????? filter
        getContentPane().add(Jfc);

    }

    public class chooseFile extends JFileChooser   //chooseFile ??? JFileChooser
    {
        File select;
        String filename;
        String filePath = "";

        public chooseFile()                           //??????
        {
            super("c:/");                                //?????????§Ö??????
        }

        public void approveSelection()                //?????????????
        {
            select = Jfc.getSelectedFile();
            //??????????

            String path = Jfc.getCurrentDirectory().getPath();
            System.out.println(path);
            JOptionPane.showMessageDialog(getContentPane(), "????????? ??" + path + "??,????????§ß????????");

            ExcelBigField.execute(path);

            JOptionPane.showMessageDialog(getContentPane(), "????????thanks for use?? ??????????????3?????????????????");
            filename = Jfc.getName(select);             //????????
            filePath = Jfc.getCurrentDirectory().toString();
            try {
                Thread.sleep(3000);
            } catch (InterruptedException e) {
                e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
            }
            System.exit(0);
            //???????????
        }

        public void cancelSelection()                 //????????????
        {
            JOptionPane.showMessageDialog(getContentPane(), "????¦Å????!");
            //???????????
            Jfc.setSelectedFile(null);                 //???Øt???????? null
            System.exit(0);
        }
    }

    public class Filter extends FileFilter         //Filter ??? FileFilter
    {
        public boolean accept(File file) {
            return (file.getName().endsWith(".xls") || file.isDirectory());
            // ?????????????????
        }

        public String getDescription() {
            return ("???????");                  //???????????????????
//            return ("XML Files(*.xml)");                  //???????????????????
        }
    }
}

